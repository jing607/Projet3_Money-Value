{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport ErrorAlert from './ErrorAlert.vue';\nexport default {\n  name: 'LoginCard',\n  components: {\n    ErrorAlert\n  },\n  data() {\n    return {\n      email: '',\n      password: '',\n      error: [],\n      user: this.$store.state.user\n    };\n  },\n  beforeCreate() {\n    this.user = this.$store.state.user;\n    if (this.user) {\n      this.$router.push('/');\n    }\n  },\n  methods: {\n    async handleSubmit() {\n      // gestionnaire d'évènement click sur le bouton d'envoi du formulaire\n      // on nettoit le panneau d'erreur\n      this.error = [];\n\n      // on fait le call api vers le endpoint /login\n      try {\n        const response = await axios.post('auth/login', {\n          email: this.email.trim(),\n          password: this.password.trim()\n        });\n\n        // si succes:\n        if (response) {\n          console.log(response);\n          if (response.status === 200) {\n            this.$store.commit('addUser', response.data.user);\n            this.$store.commit('setToken', response.data.token);\n            this.$router.push('/');\n          } else {\n            // sinon\n            throw new Error('Invalid username/password');\n          }\n        }\n      } catch (e) {\n        // echec et erreur:\n        // console.log(e)\n        this.error.push(e.message);\n      }\n    }\n  },\n  mounted() {\n    // on effece le panneau d'erreurs\n    this.error = [];\n  }\n};","map":{"version":3,"names":["axios","ErrorAlert","name","components","data","email","password","error","user","$store","state","beforeCreate","$router","push","methods","handleSubmit","response","post","trim","console","log","status","commit","token","Error","e","message","mounted"],"sources":["/Users/hj/Desktop/cours/6_Projet3_Money-Value/Projet3_Money-Value/Admin-Vue/front/src/components/login/LoginCard.vue"],"sourcesContent":["<template>\n    <div class=\"auth-wrapper\">\n      <div class=\"auth-inner\">\n        <form @submit.prevent=\"handleSubmit\">\n            <ErrorAlert v-if=\"error.length\" :error=\"error\" />\n            <h3>Login</h3>\n\n            <div class=\"form-group\">\n                <label>Email</label>\n                <input type=\"email\" class=\"form-control\" v-model=\"email\" placeholder=\"Email\" required/>\n            </div>\n\n            <div class=\"form-group mt-2\">\n                <label for=\"\">Password</label>\n                <input type=\"password\" class=\"form-control\" v-model=\"password\" placeholder=\"Password\" required/>\n            </div>\n\n            <button class=\"btn btn-primary btn-block mt-3 text-white\" type=\"submit\">Envoyer</button>\n\n            <p class=\"forgot-password text-right\">\n                <router-link to=\"forgot\">Forgot password?</router-link>\n            </p>\n        </form>\n    </div>\n  </div>\n</template>\n\n\n\n<script>\n    import axios from 'axios'\n    import ErrorAlert from './ErrorAlert.vue';\n\n    export default {\n        name: 'LoginCard',\n        components: {\n            ErrorAlert\n        },\n        data() {\n            return {\n                email: '',\n                password: '',\n                error: [],\n                user: this.$store.state.user\n            }\n        },\n        beforeCreate() {\n            this.user = this.$store.state.user\n            if(this.user) {\n                this.$router.push('/')\n            }\n        },\n        methods: {\n            async handleSubmit() {\n                // gestionnaire d'évènement click sur le bouton d'envoi du formulaire\n                // on nettoit le panneau d'erreur\n                this.error = []\n\n                // on fait le call api vers le endpoint /login\n                try {\n                    const response = await axios.post('auth/login',{\n                        email: this.email.trim(),\n                        password: this.password.trim()\n                    });\n\n                    // si succes:\n                    if(response) {\n                        console.log(response)\n                        if(response.status === 200) {\n                            this.$store.commit('addUser', response.data.user)\n                            this.$store.commit('setToken', response.data.token)\n                            this.$router.push('/');\n                        } else {\n                            // sinon\n                            throw new Error('Invalid username/password')\n                        }\n                    }\n\n                }catch (e) {\n                    // echec et erreur:\n                    // console.log(e)\n                    this.error.push(e.message)\n                }\n            }\n        },\n        mounted() {\n            // on effece le panneau d'erreurs\n            this.error = []\n        }\n    }\n</script>"],"mappings":";AA8BI,OAAOA,KAAI,MAAO,OAAM;AACxB,OAAOC,UAAS,MAAO,kBAAkB;AAEzC,eAAe;EACXC,IAAI,EAAE,WAAW;EACjBC,UAAU,EAAE;IACRF;EACJ,CAAC;EACDG,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,KAAK,EAAE,EAAE;MACTC,IAAI,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF;IAC5B;EACJ,CAAC;EACDG,YAAYA,CAAA,EAAG;IACX,IAAI,CAACH,IAAG,GAAI,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF,IAAG;IACjC,IAAG,IAAI,CAACA,IAAI,EAAE;MACV,IAAI,CAACI,OAAO,CAACC,IAAI,CAAC,GAAG;IACzB;EACJ,CAAC;EACDC,OAAO,EAAE;IACL,MAAMC,YAAYA,CAAA,EAAG;MACjB;MACA;MACA,IAAI,CAACR,KAAI,GAAI,EAAC;;MAEd;MACA,IAAI;QACA,MAAMS,QAAO,GAAI,MAAMhB,KAAK,CAACiB,IAAI,CAAC,YAAY,EAAC;UAC3CZ,KAAK,EAAE,IAAI,CAACA,KAAK,CAACa,IAAI,CAAC,CAAC;UACxBZ,QAAQ,EAAE,IAAI,CAACA,QAAQ,CAACY,IAAI,CAAC;QACjC,CAAC,CAAC;;QAEF;QACA,IAAGF,QAAQ,EAAE;UACTG,OAAO,CAACC,GAAG,CAACJ,QAAQ;UACpB,IAAGA,QAAQ,CAACK,MAAK,KAAM,GAAG,EAAE;YACxB,IAAI,CAACZ,MAAM,CAACa,MAAM,CAAC,SAAS,EAAEN,QAAQ,CAACZ,IAAI,CAACI,IAAI;YAChD,IAAI,CAACC,MAAM,CAACa,MAAM,CAAC,UAAU,EAAEN,QAAQ,CAACZ,IAAI,CAACmB,KAAK;YAClD,IAAI,CAACX,OAAO,CAACC,IAAI,CAAC,GAAG,CAAC;UAC1B,OAAO;YACH;YACA,MAAM,IAAIW,KAAK,CAAC,2BAA2B;UAC/C;QACJ;MAEJ,CAAC,QAAOC,CAAC,EAAE;QACP;QACA;QACA,IAAI,CAAClB,KAAK,CAACM,IAAI,CAACY,CAAC,CAACC,OAAO;MAC7B;IACJ;EACJ,CAAC;EACDC,OAAOA,CAAA,EAAG;IACN;IACA,IAAI,CAACpB,KAAI,GAAI,EAAC;EAClB;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}