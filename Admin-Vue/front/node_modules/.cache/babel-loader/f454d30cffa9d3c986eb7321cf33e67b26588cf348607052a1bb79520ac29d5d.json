{"ast":null,"code":"import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"auth-wrapper\"\n};\nconst _hoisted_2 = {\n  class: \"auth-inner\"\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h3\", null, \"Sign up\", -1 /* HOISTED */);\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"label\", null, [/*#__PURE__*/_createTextVNode(\"Name \"), /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"text-danger\"\n}, \"*\")], -1 /* HOISTED */);\nconst _hoisted_6 = {\n  class: \"form-group mt-2\"\n};\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"label\", null, [/*#__PURE__*/_createTextVNode(\"Email \"), /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"text-danger\"\n}, \"*\")], -1 /* HOISTED */);\nconst _hoisted_8 = {\n  class: \"form-group mt-2\"\n};\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"label\", null, [/*#__PURE__*/_createTextVNode(\"Password \"), /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"text-danger\"\n}, \"*\")], -1 /* HOISTED */);\nconst _hoisted_10 = {\n  class: \"form-group mt-2\"\n};\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"label\", null, [/*#__PURE__*/_createTextVNode(\"Confirm Password \"), /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"text-danger\"\n}, \"*\")], -1 /* HOISTED */);\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"btn btn-primary btn-block mt-3\"\n}, \"Sign Up\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ErrorAlert = _resolveComponent(\"ErrorAlert\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"form\", {\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers((...args) => $options.handleSubmit && $options.handleSubmit(...args), [\"prevent\"]))\n  }, [$data.error.length ? (_openBlock(), _createBlock(_component_ErrorAlert, {\n    key: 0,\n    error: $data.error\n  }, null, 8 /* PROPS */, [\"error\"])) : _createCommentVNode(\"v-if\", true), _hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.name = $event),\n    placeholder: \"First Name\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.name]])]), _createElementVNode(\"div\", _hoisted_6, [_hoisted_7, _withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.email = $event),\n    placeholder: \"Email\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.email]])]), _createElementVNode(\"div\", _hoisted_8, [_hoisted_9, _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.password = $event),\n    placeholder: \"Password\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.password]])]), _createElementVNode(\"div\", _hoisted_10, [_hoisted_11, _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.password_confirm = $event),\n    placeholder: \"Confirm Password\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.password_confirm]])]), _hoisted_12], 32 /* HYDRATE_EVENTS */)])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","handleSubmit","$data","error","length","_createBlock","_component_ErrorAlert","_hoisted_3","_hoisted_4","_hoisted_5","type","name","$event","placeholder","required","_hoisted_6","_hoisted_7","email","_hoisted_8","_hoisted_9","password","_hoisted_10","_hoisted_11","password_confirm","_hoisted_12"],"sources":["/Users/hj/Desktop/cours/6_Projet3_Money-Value/Projet3_Money-Value/Admin-Vue/front/src/components/login/RegisterCard.vue"],"sourcesContent":["<template>\n    <div class=\"auth-wrapper\">\n      <div class=\"auth-inner\">\n        <form @submit.prevent=\"handleSubmit\">\n            <ErrorAlert v-if=\"error.length\" :error=\"error\" />\n            <h3>Sign up</h3>\n\n            <div class=\"form-group\">\n                <label>Name <span class=\"text-danger\">*</span></label>\n                <input type=\"text\" class=\"form-control\" v-model=\"name\" placeholder=\"First Name\" required>\n            </div>\n            \n            <div class=\"form-group mt-2\">\n                <label>Email <span class=\"text-danger\">*</span></label>\n                <input type=\"email\" class=\"form-control\" v-model=\"email\" placeholder=\"Email\"  required>\n            </div>\n\n            <div class=\"form-group mt-2\">\n                <label>Password <span class=\"text-danger\">*</span></label>\n                <input type=\"password\" class=\"form-control\" v-model=\"password\" placeholder=\"Password\"  required>\n            </div>\n\n            <div class=\"form-group mt-2\">\n                <label>Confirm Password <span class=\"text-danger\">*</span></label>\n                <input type=\"password\" class=\"form-control\" v-model=\"password_confirm\" placeholder=\"Confirm Password\"  required>\n            </div>\n\n            <button class=\"btn btn-primary btn-block mt-3\">Sign Up</button>\n        </form>\n    </div>\n  </div>\n</template>\n\n<script>\n    import axios from 'axios'\n    import ErrorAlert from './ErrorAlert.vue';\n\n    export default {\n        name: 'RegisterCard',\n        components: {\n            ErrorAlert\n        },\n        data() {\n            return {\n                name: '',\n                email: '',\n                password: '',\n                password_confirm: '',\n                error: [],\n                user: this.$store.state.user,\n            }\n        },\n        beforeCreate() {\n            this.user = this.$store.state.user\n            if(this.user) {\n                this.$router.push('/')\n            }\n        },\n        methods: {\n            async handleSubmit(){\n                // gestionnaire du cliclk sur le bouton d'envoi du formulaire:\n                // si la validation ne passe pas on sort\n                if(!this.validateform()) {\n                    return;\n                }\n\n                // on effectue le call api vers le endpoint /sanctum/csrf-cookie pour récup \n                // le jeton csrf\n                try {\n                    const csrf = await axios.get('/sanctum/csrf-cookie')\n                    // console.log(csrf)\n                    if(csrf.status !== 204){\n                        throw new Error('Csrf protection disabled!')\n                    }\n\n                    // puis on effectue le call api vers le endpoint /register\n                    const res = await axios.post('register', {\n                        name: this.name.trim(),\n                        email: this.email.trim(),\n                        password: this.password.trim(),\n                        password_confirmation: this.password_confirm.trim(),\n                    }, \n                    // {\n                    //     headers: {\n                    //         'X-XSRF-TOKEN': (() => {\n                    //             const name = 'XSRF-TOKEN'\n                    //             const cookies = '; ' + document.cookie\n                    //             const parts = cookies.split('; ' + name + '=')\n                    //             const value = parts.length == 2 ? parts.pop().split(';').shift() : null\n\n                    //             console.log('>>> XSRF-TOKEN', value)\n\n                    //             return value\n                    //         })(),\n                    //         'X-Requested-With': 'XMLHttpRequest',\n                    //     },\n                    // }\n                    );\n\n                    if(res) {\n                        console.log(res);\n                    }\n\n                    // succes: on redirige vers la page de /login\n                    this.$router.push('/login');\n                }catch (e) {\n                    // echec: il y a erreur et on l'affiche\n                    this.error.push('Error Occured!');\n                }\n            },\n            validateform() {\n                // méthode de validation des données utilisateurs\n                const name = this.name.trim()\n                const email = this.email.trim()\n                const password = this.password.trim()\n                const password_confirmation = this.password_confirm.trim()\n\n                // données non vides\n                if(\n                    name=== '' ||\n                    email === '' ||\n                    password === '' ||\n                    password_confirmation === ''\n                ) {\n                    this.error.push('All fields must be filled.')\n                }\n\n                // le champ nams: 3 caractères mini\n                if(name.length < 3) {\n                    this.error.push('the field NAME must be at least 3 characters long.')\n                }\n                \n                // validation d'email\n                if(!this.isValidEmail(email)) {\n                    this.error.push('Please enter a valid email.')\n                }\n\n                // password min 5 caractères\n                if(password.length < 5) {\n                    this.error.push('Passwords have at least 6 characters')\n                }\n\n                // password et password_confirmation doivent être identiques\n                if(password !== password_confirmation) {\n                    this.error.push('Passwords must be identical!')\n                }\n                \n                return !this.error.length\n\n            },\n            isValidEmail(email) {\n                // verification d'émail par regexp\n                const emailRegex = /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/;\n                return emailRegex.test(email);\n            },\n        },\n        mounted() {\n            // interdit l'acces si 'lutilisateur est loggé\n            if(this.user) {\n                this.$router.push('/')\n            }\n        },\n    }\n</script>"],"mappings":";;EACSA,KAAK,EAAC;AAAc;;EAClBA,KAAK,EAAC;AAAY;gCAGjBC,mBAAA,CAAgB,YAAZ,SAAO;;EAEND,KAAK,EAAC;AAAY;gCACnBC,mBAAA,CAAsD,gB,8BAA/C,OAAK,G,aAAAA,mBAAA,CAAkC;EAA5BD,KAAK,EAAC;AAAa,GAAC,GAAC,E;;EAItCA,KAAK,EAAC;AAAiB;gCACxBC,mBAAA,CAAuD,gB,8BAAhD,QAAM,G,aAAAA,mBAAA,CAAkC;EAA5BD,KAAK,EAAC;AAAa,GAAC,GAAC,E;;EAIvCA,KAAK,EAAC;AAAiB;gCACxBC,mBAAA,CAA0D,gB,8BAAnD,WAAS,G,aAAAA,mBAAA,CAAkC;EAA5BD,KAAK,EAAC;AAAa,GAAC,GAAC,E;;EAI1CA,KAAK,EAAC;AAAiB;iCACxBC,mBAAA,CAAkE,gB,8BAA3D,mBAAiB,G,aAAAA,mBAAA,CAAkC;EAA5BD,KAAK,EAAC;AAAa,GAAC,GAAC,E;iCAIvDC,mBAAA,CAA+D;EAAvDD,KAAK,EAAC;AAAgC,GAAC,SAAO;;;;uBA1B9DE,mBAAA,CA6BI,OA7BJC,UA6BI,GA5BFF,mBAAA,CA2BI,OA3BJG,UA2BI,GA1BFH,mBAAA,CAyBO;IAzBAI,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,KAAAC,IAAA,KAAUC,QAAA,CAAAC,YAAA,IAAAD,QAAA,CAAAC,YAAA,IAAAF,IAAA,CAAY;MACbG,KAAA,CAAAC,KAAK,CAACC,MAAM,I,cAA9BC,YAAA,CAAiDC,qBAAA;;IAAhBH,KAAK,EAAED,KAAA,CAAAC;2EACxCI,UAAgB,EAEhBf,mBAAA,CAGM,OAHNgB,UAGM,GAFFC,UAAsD,E,gBACtDjB,mBAAA,CAAyF;IAAlFkB,IAAI,EAAC,MAAM;IAACnB,KAAK,EAAC,cAAc;+DAAUW,KAAA,CAAAS,IAAI,GAAAC,MAAA;IAAEC,WAAW,EAAC,YAAY;IAACC,QAAQ,EAAR;iDAA/BZ,KAAA,CAAAS,IAAI,E,KAGzDnB,mBAAA,CAGM,OAHNuB,UAGM,GAFFC,UAAuD,E,gBACvDxB,mBAAA,CAAuF;IAAhFkB,IAAI,EAAC,OAAO;IAACnB,KAAK,EAAC,cAAc;+DAAUW,KAAA,CAAAe,KAAK,GAAAL,MAAA;IAAEC,WAAW,EAAC,OAAO;IAAEC,QAAQ,EAAR;iDAA5BZ,KAAA,CAAAe,KAAK,E,KAG3DzB,mBAAA,CAGM,OAHN0B,UAGM,GAFFC,UAA0D,E,gBAC1D3B,mBAAA,CAAgG;IAAzFkB,IAAI,EAAC,UAAU;IAACnB,KAAK,EAAC,cAAc;+DAAUW,KAAA,CAAAkB,QAAQ,GAAAR,MAAA;IAAEC,WAAW,EAAC,UAAU;IAAEC,QAAQ,EAAR;iDAAlCZ,KAAA,CAAAkB,QAAQ,E,KAGjE5B,mBAAA,CAGM,OAHN6B,WAGM,GAFFC,WAAkE,E,gBAClE9B,mBAAA,CAAgH;IAAzGkB,IAAI,EAAC,UAAU;IAACnB,KAAK,EAAC,cAAc;+DAAUW,KAAA,CAAAqB,gBAAgB,GAAAX,MAAA;IAAEC,WAAW,EAAC,kBAAkB;IAAEC,QAAQ,EAAR;iDAAlDZ,KAAA,CAAAqB,gBAAgB,E,KAGzEC,WAA+D,C"},"metadata":{},"sourceType":"module","externalDependencies":[]}